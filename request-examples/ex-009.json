{
  "expression": "zip(cross_join(split(customerIds,','), split(channels,';')), '.', substring(split(segments,','), 1, 4), '.', substring(registrationDate, 1, 4), '.', (((income / avgIncome * incomeWeight + age / avgAge * ageWeight + purchaseHistory / avgPurchase * purchaseWeight + engagementScore * engagementWeight) / totalWeight) > premiumThreshold ? (equals(substring(split(preferences,','), 1, 6), 'Premiu') & loyaltyPoints > '5000' & lastPurchaseDays < '30' ? '.vip_platinum' : '.vip_gold') : (((income / avgIncome * incomeWeight + age / avgAge * ageWeight + purchaseHistory / avgPurchase * purchaseWeight + engagementScore * engagementWeight) / totalWeight) > standardThreshold ? '.standard_active' : '.budget_nurture')))",
  "inputs": {
    "customerIds": "C001,C002",
    "channels": "Email;SMS;Push;Direct",
    "segments": "Premium,Standard,Budget",
    "registrationDate": "2022-08-20",
    "income": "85000",
    "avgIncome": "65000",
    "incomeWeight": "0.3",
    "age": "35",
    "avgAge": "40",
    "ageWeight": "0.2",
    "purchaseHistory": "12000",
    "avgPurchase": "8000",
    "purchaseWeight": "0.3",
    "engagementScore": "8.5",
    "engagementWeight": "0.2",
    "totalWeight": "1.0",
    "premiumThreshold": "1.2",
    "preferences": "Premium,Exclusive,Luxury",
    "loyaltyPoints": "7500",
    "lastPurchaseDays": "15",
    "standardThreshold": "0.8"
  }
}